- name: Fetch bastion users ssh key
  ansible.builtin.fetch:
    src: "/home/{{ item.username }}/.ssh/id_rsa.pub"
    dest: "{{ bastionLocalDir }}/{{ item.username }}/ssh/{{ item.username }}.pub"
    flat: yes
  loop: "{{ bastionUsers }}"

- name: Add ssh key in authorized_keys
  ansible.posix.authorized_key:
    user: "{{ item.username }}"
    state: present
    key: "{{ item.sshKey }}"
  no_log: true
  loop: "{{ bastionUsers }}"
