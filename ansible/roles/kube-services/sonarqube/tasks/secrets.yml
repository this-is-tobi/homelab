- name: Generate random admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.sonarqube.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/sonarqube.yml
  when: sonarqube.password == ""

- name: Generate random monitoring password
  ansible.builtin.shell:
    cmd: |
      yq -i '.sonarqube.monitoringPasscode = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/sonarqube.yml
  when: sonarqube.monitoringPasscode == ""

- name: Generate random postgres admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.sonarqube.postgres.admin.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/sonarqube.yml
  when: sonarqube.postgres.admin.password == ""

- name: Generate random postgres app password
  ansible.builtin.shell:
    cmd: |
      yq -i '.sonarqube.postgres.app.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/sonarqube.yml
  when: sonarqube.postgres.app.password == ""
