- name: Generate random admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.keycloak.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/keycloak.yml
  when: keycloak.password == ""

- name: Generate random postgres admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.keycloak.postgres.admin.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/keycloak.yml
  when: keycloak.postgres.admin.password == ""

- name: Generate random postgres app password
  ansible.builtin.shell:
    cmd: |
      yq -i '.keycloak.postgres.app.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/keycloak.yml
  when: keycloak.postgres.app.password == ""
