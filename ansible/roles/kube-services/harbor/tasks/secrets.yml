- name: Generate random admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.harbor.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/harbor.yml
  when: harbor.password == ""

- name: Generate random postgres admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.harbor.postgres.admin.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/harbor.yml
  when: harbor.postgres.admin.password == ""

- name: Generate random postgres app password
  ansible.builtin.shell:
    cmd: |
      yq -i '.harbor.postgres.app.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/harbor.yml
  when: harbor.postgres.app.password == ""
