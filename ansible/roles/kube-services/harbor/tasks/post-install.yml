- name: Update harbor config
  ansible.builtin.uri:
    method: PUT
    url: https://{{ harbor.domain }}/api/v2.0/configurations
    password: "{{ harbor.password }}"
    user: admin
    force_basic_auth: true
    body_format: json
    body: 
      "auth_mode": "oidc_auth"
      "notification_enable": true
      "oidc_admin_group": "admin"
      "oidc_auto_onboard": true
      "oidc_client_id": "{{ harbor.keycloak.clientId }}"
      "oidc_endpoint": "https://{{ keycloak.domain }}/realms/{{ keycloak.realm }}"
      "oidc_extra_redirect_parms": "{}"
      "oidc_group_filter": ""
      "oidc_groups_claim": "groups"
      "oidc_name": "keycloak"
      "oidc_scope": "openid,profile,email,groups"
      "oidc_user_claim": "email"
      "project_creation_restriction": "adminonly"
      "quota_per_project_enable": true
      "read_only": false
      "robot_name_prefix": "robot$"
      "robot_token_duration": 30
      "self_registration": false
      "oidc_client_secret": "{{ harbor.keycloak.clientSecret }}"
