- name: Generate random admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.mattermost.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/mattermost.yml
  when: mattermost.password == ""

- name: Generate random postgres admin password
  ansible.builtin.shell:
    cmd: |
      yq -i '.mattermost.postgres.admin.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/mattermost.yml
  when: mattermost.postgres.admin.password == ""

- name: Generate random postgres app password
  ansible.builtin.shell:
    cmd: |
      yq -i '.mattermost.postgres.app.password = "{{ lookup('ansible.builtin.password', '/dev/null', length=24, chars=['ascii_letters', 'digits']) }}"' ../inventory/group_vars/kube-services/mattermost.yml
  when: mattermost.postgres.app.password == ""
