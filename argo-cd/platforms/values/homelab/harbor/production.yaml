harbor:
  registry:
    replicas: 1
    registry:
      image:
        repository: "ghcr.io/octohelm/harbor/registry-photon"
    controller:
      image:
        repository: "ghcr.io/octohelm/harbor/harbor-registryctl"
  portal:
    replicas: 2
    repository: "ghcr.io/octohelm/harbor/harbor-portal"
  nginx:
    replicas: 2
    repository: "ghcr.io/octohelm/harbor/nginx-photon"
  core:
    replicas: 2
    repository: "ghcr.io/octohelm/harbor/harbor-core"
  jobservice:
    replicas: 2
    repository: "ghcr.io/octohelm/harbor/harbor-jobservice"
  trivy:
    replicas: 2
    image:
      repository: "ghcr.io/octohelm/harbor/trivy-adapter-photon"
  redis:
    internal:
      image:
        repository: "ghcr.io/octohelm/harbor/redis-photon"
  exporter:
    replicas: 2
  externalURL: "https://registry.ohmlab.fr"
  ingress:
    hosts:
      core: "registry.ohmlab.fr"
    tls:
      secret:
        secretName: "registry.ohmlab.fr-tls"
  persistence:
    persistentVolumeClaim:
      registry:
        accessMode: "ReadWriteOnce"
        size: "5Gi"
      jobservice:
        accessMode: "ReadWriteOnce"
        size: "1Gi"
      redis:
        accessMode: "ReadWriteOnce"
        size: "1Gi"
      trivy:
        accessMode: "ReadWriteOnce"
        size: "1Gi"
    imageChartStorage:
      disableredirect: true
    s3:
      existingSecret: "harbor-s3" # REGISTRY_STORAGE_S3_ACCESSKEY / REGISTRY_STORAGE_S3_SECRETKEY
      region: "fr-par"
      bucket: "harbor"
      regionendpoint: "https://s3.fr-par.scw.cloud"

cnpg:
  mode: "primary"
  credentials:
    existingSecrets:
      enabled: true
      postgres:
        secretName: "harbor-pg-cluster-admin"
      app:
        secretName: "harbor-pg-cluster-app"
  backup:
    enabled: true
    endpointURL: "https://s3.fr-par.scw.cloud"
    destinationPath: "s3://ohmlab-backups/cnpg"
    s3Credentials:
      create: false
      secretName: "harbor-pg-cluster-backup"
      accessKeyId:
        key: "S3_ACCESS_KEY"
      secretAccessKey:
        key: "S3_SECRET_KEY"
      region:
        key: "S3_REGION"

vso:
  vaultStaticSecrets:
    harborAdmin:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborSecretkey:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborS3:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborDbInfos:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborDbAdmin:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborDbApp:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborPgBackup:
      mount: "homelab"
      path: "platforms/production/harbor"
    harborSso:
      mount: "homelab"
      path: "platforms/production/harbor"
