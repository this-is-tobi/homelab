sonarqube:
  ingress:
    hosts:
    - name: "sonarqube.ohmlab.fr"
      path: "/"
    tls:
    - hosts:
      - "sonarqube.ohmlab.fr"
      secretName: "sonarqube.ohmlab.fr-tls"
  jdbcOverwrite:
    jdbcUrl: "jdbc:postgresql://sonarqube-pg-cluster-rw:5432/sonarqube?socketTimeout=1500"
    jdbcUsername: "sonarqube"
  sonarProperties:
    sonar.core.serverBaseURL: "https://sonarqube.ohmlab.fr"
    sonar.auth.oidc.issuerUri: "https://sso.ohmlab.fr/realms/homelab"
    sonar.auth.oidc.clientId.secured: "sonarqube"
    # sonar.auth.oidc.clientSecret.secured: ""
  sonarSecretProperties: "sonarqube-properties"

cnpg:
  mode: "primary"
  credentials:
    existingSecrets:
      enabled: true
      postgres:
        secretName: "sonarqube-pg-cluster-admin"
      app:
        secretName: "sonarqube-pg-cluster-app"
  backup:
    enabled: true
    endpointURL: "https://s3.fr-par.scw.cloud"
    destinationPath: "s3://ohmlab-backups/cnpg"
    s3Credentials:
      create: false
      secretName: "sonarqube-pg-cluster-backup"
      accessKeyId:
        key: "S3_ACCESS_KEY"
      secretAccessKey:
        key: "S3_SECRET_KEY"
      region:
        key: "S3_REGION"

vso:
  vaultStaticSecrets:
    sonarqubeAdmin:
      mount: "homelab"
      path: "platforms/production/sonarqube"
    sonarqubeProperties:
      mount: "homelab"
      path: "platforms/production/sonarqube"
    sonarqubeDbInfos:
      mount: "homelab"
      path: "platforms/production/sonarqube"
    sonarqubeDbAdmin:
      mount: "homelab"
      path: "platforms/production/sonarqube"
    sonarqubeDbApp:
      mount: "homelab"
      path: "platforms/production/sonarqube"
    sonarqubePgBackup:
      mount: "homelab"
      path: "platforms/production/sonarqube"
    sonarqubeSso:
      mount: "homelab"
      path: "platforms/production/sonarqube"
