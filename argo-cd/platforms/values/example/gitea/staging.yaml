gitea:
  ingress:
    hosts:
    - host: "gitea.staging.example.com"
      paths:
      - path: "/"
        pathType: "Prefix"
    tls:
    - secretName: "gitea.staging.example.com-tls"
      hosts:
      - "gitea.staging.example.com"
  gitea:
    admin:
      username: "admin"
      email: "admin@staging.example.com"
      existingSecret: "gitea-admin"
    oauth:
    - name: "Keycloak"
      provider: "openidConnect"
      key: "gitea"
      secret: ""
      autoDiscoverUrl: "https://keycloak.staging.example.com/realms/homelab/.well-known/openid-configuration"
      scopes: "openid profile email roles groups"
      adminGroup: "admin"
      groupClaimName: "groups"
      # groupTeamMap: ""
      # groupTeamMapRemoval: true
    config:
      database:
        HOST: "gitea-pg-cluster-rw"
        NAME: "gitea"
        USER: "gitea"
      server:
        DOMAIN: "gitea.staging.example.com"
        ROOT_URL: "https://gitea.staging.example.com"
      openid:
        WHITELISTED_URIS: "keycloak.staging.example.com"
    additionalConfigSources: []
    # - secret:
    #     secretName: "gitea-app-ini-oauth"
    # - configMap:
    #     name: "gitea-app-ini-plaintext"
    additionalConfigFromEnvs:
    - name: "GITEA__database__PASSWD"
      valueFrom:
        secretKeyRef:
          name: "gitea-pg-cluster-app"
          key: "password"

cnpg:
  mode: "primary"
  credentials:
    existingSecrets:
      enabled: true
      postgres:
        secretName: "gitea-pg-cluster-admin"
      app:
        secretName: "gitea-pg-cluster-app"
  backup:
    enabled: true
    endpointURL: "https://s3.staging.example.com"
    destinationPath: "s3://backups/cnpg"
    s3Credentials:
      create: false
      secretName: "gitea-pg-cluster-backup"
      accessKeyId:
        key: "S3_ACCESS_KEY"
      secretAccessKey:
        key: "S3_SECRET_KEY"
      region:
        key: "S3_REGION"
